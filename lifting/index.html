<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Lifting Plan</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

:root {
  --bg: #000;
  --card: #111;
  --card-alt: #1a1a1a;
  --accent-a: #e94560;
  --accent-b: #4a9eff;
  --text: #eee;
  --text-dim: #666;
  --border: #222;
  --green: #4ade80;
  --yellow: #fbbf24;
  --done: #333;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100dvh;
  padding-bottom: env(safe-area-inset-bottom, 20px);
}

/* Day selector */
.day-selector {
  display: flex;
  gap: 8px;
  padding: 12px 12px 10px;
  padding-top: calc(12px + env(safe-area-inset-top, 0px));
  position: sticky;
  top: 0;
  background: var(--bg);
  z-index: 100;
  border-bottom: 1px solid var(--border);
}

.day-btn {
  flex: 1;
  padding: 12px 8px;
  border: 2px solid var(--border);
  border-radius: 12px;
  background: var(--card);
  color: var(--text);
  font-size: 15px;
  font-weight: 600;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s;
}
.day-btn .label { font-size: 12px; color: var(--text-dim); display: block; margin-top: 2px; }
.day-btn.active-a { border-color: var(--accent-a); background: rgba(233,69,96,0.12); }
.day-btn.active-b { border-color: var(--accent-b); background: rgba(74,158,255,0.1); }

/* Session container */
.session { display: none; padding: 0 12px 20px; }
.session.visible { display: block; }

/* Section headers */
.section-header {
  font-size: 12px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  padding: 12px 4px 6px;
  color: var(--text-dim);
  border-bottom: 1px solid var(--border);
  margin-bottom: 4px;
}
.section-header.warmup { color: var(--green); border-color: rgba(74,222,128,0.2); }
.section-header.work { color: var(--accent-a); border-color: rgba(233,69,96,0.2); }
.section-header.mobility { color: #818cf8; border-color: rgba(129,140,248,0.2); }
.section-header.optional { color: var(--yellow); border-color: rgba(251,191,36,0.2); }

/* Exercise rows */
.exercise {
  display: grid;
  grid-template-columns: 66px 1fr auto;
  align-items: center;
  gap: 6px;
  padding: 9px 4px;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  transition: opacity 0.3s;
}
.exercise:active { background: rgba(255,255,255,0.03); border-radius: 8px; }

.exercise .check-col {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
}

.exercise .num {
  font-size: 11px;
  font-weight: 700;
  color: var(--text-dim);
  text-align: center;
}

/* Set checkboxes */
.set-dots {
  display: flex;
  gap: 4px;
}
.set-dot {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  border: 2px solid var(--text-dim);
  background: transparent;
  transition: all 0.2s;
  cursor: pointer;
}
.set-dot.filled {
  background: var(--green);
  border-color: var(--green);
}

.exercise.all-done {
  opacity: 0.35;
}

.exercise .info { min-width: 0; cursor: pointer; }
.exercise .name {
  font-size: 15px;
  font-weight: 600;
  line-height: 1.3;
}
.exercise .meta {
  font-size: 12px;
  color: var(--text-dim);
  margin-top: 1px;
}
.exercise .weight-row {
  display: flex;
  align-items: center;
  gap: 4px;
  margin-top: 3px;
}
.weight-input {
  width: 48px;
  font-size: 12px;
  font-family: inherit;
  color: var(--text);
  background: var(--card-alt);
  border: 1px solid var(--border);
  border-radius: 5px;
  padding: 2px 5px;
  text-align: center;
  -webkit-appearance: none;
  appearance: none;
}
.weight-input::placeholder { color: #444; }
.weight-input:focus {
  outline: none;
  border-color: var(--accent-b);
}
.weight-label {
  font-size: 11px;
  color: #444;
}

.exercise .rpe-wrap {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 4px;
}

.exercise .rpe {
  font-size: 11px;
  font-weight: 700;
  padding: 2px 7px;
  border-radius: 6px;
  white-space: nowrap;
}
.rpe-high { background: rgba(233,69,96,0.2); color: #f87171; }
.rpe-med { background: rgba(251,191,36,0.12); color: #fbbf24; }
.rpe-low { background: rgba(74,222,128,0.12); color: #4ade80; }

/* Timer button */
.timer-btn {
  font-size: 13px;
  font-weight: 600;
  padding: 6px 12px;
  border-radius: 8px;
  border: 1.5px solid var(--accent-b);
  background: transparent;
  color: var(--accent-b);
  cursor: pointer;
  white-space: nowrap;
  transition: all 0.2s;
  min-height: 32px;
}
.timer-btn:active { background: rgba(74,158,255,0.2); }

/* Timer overlay */
.timer-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.92);
  z-index: 300;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 24px;
}
.timer-overlay.open { display: flex; }

.timer-display {
  font-size: 72px;
  font-weight: 200;
  font-variant-numeric: tabular-nums;
  color: var(--text);
  letter-spacing: -2px;
}
.timer-display.done {
  color: var(--green);
}

.timer-label {
  font-size: 14px;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 1px;
}

.timer-ring {
  width: 220px;
  height: 220px;
  position: relative;
}
.timer-ring svg {
  width: 100%;
  height: 100%;
  transform: rotate(-90deg);
}
.timer-ring .track {
  fill: none;
  stroke: var(--border);
  stroke-width: 4;
}
.timer-ring .progress {
  fill: none;
  stroke: var(--accent-b);
  stroke-width: 4;
  stroke-linecap: round;
  transition: stroke-dashoffset 0.3s linear;
}
.timer-ring .progress.done {
  stroke: var(--green);
}
.timer-ring .time-center {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.timer-cancel {
  padding: 14px 48px;
  border-radius: 12px;
  border: 1.5px solid var(--border);
  background: var(--card);
  color: var(--text);
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
}
.timer-cancel:active { background: var(--card-alt); }

/* Detail overlay */
.overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.8);
  z-index: 200;
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
}
.overlay.open { display: flex; align-items: flex-end; }

.detail-sheet {
  background: var(--card);
  width: 100%;
  max-height: 85dvh;
  border-radius: 16px 16px 0 0;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding: 0 16px 32px;
  padding-bottom: calc(32px + env(safe-area-inset-bottom, 0px));
}

.sheet-handle {
  width: 36px;
  height: 4px;
  background: #444;
  border-radius: 2px;
  margin: 10px auto 16px;
}

.detail-sheet h2 {
  font-size: 20px;
  font-weight: 700;
  margin-bottom: 16px;
  padding-right: 40px;
}

.detail-sheet .close-btn {
  position: absolute;
  top: 16px;
  right: 16px;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  border: none;
  background: rgba(255,255,255,0.08);
  color: var(--text);
  font-size: 18px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.detail-section {
  margin-bottom: 16px;
}
.detail-section h3 {
  font-size: 13px;
  font-weight: 700;
  text-transform: uppercase;
  color: var(--text-dim);
  margin-bottom: 8px;
  letter-spacing: 0.3px;
}
.detail-section p, .detail-section li {
  font-size: 15px;
  line-height: 1.55;
  color: #aab;
}
.detail-section ul {
  list-style: none;
  padding: 0;
}
.detail-section li {
  padding: 4px 0 4px 16px;
  position: relative;
}
.detail-section li::before {
  content: "\2022";
  position: absolute;
  left: 0;
  color: var(--text-dim);
}

/* Global cues banner */
.cues-banner {
  margin: 8px 0 4px;
  padding: 10px 12px;
  background: var(--card-alt);
  border-radius: 10px;
  border-left: 3px solid var(--text-dim);
}
.cues-banner summary {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-dim);
  cursor: pointer;
  list-style: none;
}
.cues-banner summary::-webkit-details-marker { display: none; }
.cues-banner summary::before { content: "\25B8 "; }
.cues-banner[open] summary::before { content: "\25BE "; }
.cues-banner .cue-list {
  margin-top: 8px;
  font-size: 13px;
  line-height: 1.5;
  color: #777;
}
.cues-banner .cue-list p { margin-bottom: 6px; }
.cues-banner .cue-list strong { color: var(--text); }

/* Reset button */
.reset-bar {
  text-align: center;
  padding: 12px 0 4px;
}
.reset-btn {
  font-size: 12px;
  color: var(--text-dim);
  background: none;
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 6px 16px;
  cursor: pointer;
}
.reset-btn:active { background: var(--card); }
</style>
</head>
<body>

<div class="day-selector">
  <button class="day-btn" id="btn-a" onclick="showSession('a')">
    Wed<span class="label">Session A</span>
  </button>
  <button class="day-btn" id="btn-b" onclick="showSession('b')">
    Sun<span class="label">Session B</span>
  </button>
</div>

<!-- SESSION A -->
<div class="session" id="session-a">
  <details class="cues-banner">
    <summary>Global Cues</summary>
    <div class="cue-list">
      <p><strong>RPE 7-8:</strong> Stop with ~2-3 reps in the tank. If form breaks, set is over.</p>
      <p><strong>Brace:</strong> Inhale into beltline/ribs, tighten midsection, exhale through sticking point.</p>
      <p><strong>Foot tripod:</strong> Big toe, little toe, heel anchored. Knees track over toes.</p>
    </div>
  </details>

  <div class="section-header warmup">Warm-up &middot; ~5 min &middot; no rest</div>

  <div class="exercise" data-key="lat-walks" data-sets="1" data-rest="0">
    <div class="check-col">
      <div class="num">&mdash;</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('lat-walks')">
      <div class="name">Banded Lateral Walks</div>
      <div class="meta">1&times;10 steps each way</div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-low">&mdash;</div>
    </div>
  </div>

  <div class="exercise" data-key="glute-bridge" data-sets="1" data-rest="0">
    <div class="check-col">
      <div class="num">&mdash;</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('glute-bridge')">
      <div class="name">Banded Glute Bridges</div>
      <div class="meta">1&times;10 &middot; 2-sec hold</div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-low">&mdash;</div>
    </div>
  </div>

  <div class="exercise" data-key="leg-swings" data-sets="1" data-rest="0">
    <div class="check-col">
      <div class="num">&mdash;</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('leg-swings')">
      <div class="name">Leg Swings</div>
      <div class="meta">1&times;10 each &middot; front/back + lateral</div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-low">&mdash;</div>
    </div>
  </div>

  <div class="section-header work">Work Sets</div>

  <div class="exercise" data-key="trap-bar-dl" data-sets="3" data-rest="150">
    <div class="check-col">
      <div class="num">1</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('trap-bar-dl')">
      <div class="name">Trap Bar Deadlift</div>
      <div class="meta">3&times;5 &middot; Rest 2-3 min</div>
      <div class="weight-row" onclick="event.stopPropagation()">
        <input class="weight-input" data-weight-key="trap-bar-dl" placeholder="—" inputmode="text">
        <span class="weight-label">lbs</span>
      </div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-high">7-8</div>
      <button class="timer-btn" onclick="startTimer(150, 'Trap Bar Deadlift')">2:30</button>
    </div>
  </div>

  <div class="exercise" data-key="bss" data-sets="3" data-rest="105">
    <div class="check-col">
      <div class="num">2</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('bss')">
      <div class="name">Bulgarian Split Squat (DB)</div>
      <div class="meta">3&times;8/side &middot; Rest 1:30-2:00</div>
      <div class="weight-row" onclick="event.stopPropagation()">
        <input class="weight-input" data-weight-key="bss" placeholder="—" inputmode="text">
        <span class="weight-label">lbs ea</span>
      </div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-med">7</div>
      <button class="timer-btn" onclick="startTimer(105, 'Bulgarian Split Squat')">1:45</button>
    </div>
  </div>

  <div class="exercise" data-key="copenhagen" data-sets="3" data-rest="75">
    <div class="check-col">
      <div class="num">3</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('copenhagen')">
      <div class="name">Copenhagen Plank</div>
      <div class="meta">3&times;20-30 sec/side &middot; Rest 1-1:30</div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-med">7</div>
      <button class="timer-btn" onclick="startTimer(75, 'Copenhagen Plank')">1:15</button>
    </div>
  </div>

  <div class="exercise" data-key="calf-raise-heavy" data-sets="3" data-rest="90">
    <div class="check-col">
      <div class="num">4</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('calf-raise-heavy')">
      <div class="name">Heavy Calf Raise</div>
      <div class="meta">3&times;10 &middot; 3s down, 2s pause &middot; Rest 1:30</div>
      <div class="weight-row" onclick="event.stopPropagation()">
        <input class="weight-input" data-weight-key="calf-raise-heavy" placeholder="—" inputmode="text">
        <span class="weight-label">lbs</span>
      </div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-med">7</div>
      <button class="timer-btn" onclick="startTimer(90, 'Heavy Calf Raise')">1:30</button>
    </div>
  </div>

  <div class="exercise" data-key="pallof" data-sets="3" data-rest="52">
    <div class="check-col">
      <div class="num">5</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('pallof')">
      <div class="name">Pallof Press</div>
      <div class="meta">3&times;8/side &middot; Rest 0:45-1:00</div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-low">6-7</div>
      <button class="timer-btn" onclick="startTimer(52, 'Pallof Press')">0:52</button>
    </div>
  </div>

  <div class="section-header optional">Optional &middot; if feeling fresh</div>

  <div class="exercise" data-key="hip-flexor-march" data-sets="3" data-rest="52">
    <div class="check-col">
      <div class="num">+</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('hip-flexor-march')">
      <div class="name">Banded Hip Flexor March</div>
      <div class="meta">3&times;10/side &middot; Rest 0:45-1:00</div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-low">6-7</div>
      <button class="timer-btn" onclick="startTimer(52, 'Hip Flexor March')">0:52</button>
    </div>
  </div>

  <div class="reset-bar">
    <button class="reset-btn" onclick="resetSets('a')">Reset Sets</button>
  </div>
</div>

<!-- SESSION B -->
<div class="session" id="session-b">
  <details class="cues-banner">
    <summary>Global Cues</summary>
    <div class="cue-list">
      <p><strong>RPE 6-7:</strong> Stop with ~3-4 reps in the tank. If form breaks, set is over.</p>
      <p><strong>Brace:</strong> Inhale into beltline/ribs, tighten midsection, exhale through sticking point.</p>
      <p><strong>Foot tripod:</strong> Big toe, little toe, heel anchored. Knees track over toes.</p>
    </div>
  </details>

  <div class="section-header mobility">Mobility Flow &middot; ~8 min &middot; no rest</div>

  <div class="exercise" data-key="hip-switches" data-sets="1" data-rest="0">
    <div class="check-col">
      <div class="num">&mdash;</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('hip-switches')">
      <div class="name">90/90 Hip Switches</div>
      <div class="meta">1&times;8 each direction</div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-low">&mdash;</div>
    </div>
  </div>

  <div class="exercise" data-key="hip-cars" data-sets="1" data-rest="0">
    <div class="check-col">
      <div class="num">&mdash;</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('hip-cars')">
      <div class="name">Hip CARs</div>
      <div class="meta">1&times;5 each direction</div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-low">&mdash;</div>
    </div>
  </div>

  <div class="exercise" data-key="couch-stretch" data-sets="1" data-rest="0">
    <div class="check-col">
      <div class="num">&mdash;</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('couch-stretch')">
      <div class="name">Couch Stretch / Hip Flexor</div>
      <div class="meta">1&times;45 sec/side</div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-low">&mdash;</div>
    </div>
  </div>

  <div class="exercise" data-key="ankle-circles" data-sets="1" data-rest="0">
    <div class="check-col">
      <div class="num">&mdash;</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('ankle-circles')">
      <div class="name">Ankle Circles</div>
      <div class="meta">1&times;10 each direction</div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-low">&mdash;</div>
    </div>
  </div>

  <div class="section-header work">Work Sets</div>

  <div class="exercise" data-key="sl-rdl" data-sets="3" data-rest="75">
    <div class="check-col">
      <div class="num">1</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('sl-rdl')">
      <div class="name">Single-Leg RDL (DB)</div>
      <div class="meta">3&times;8/side &middot; Rest 1-1:30</div>
      <div class="weight-row" onclick="event.stopPropagation()">
        <input class="weight-input" data-weight-key="sl-rdl" placeholder="—" inputmode="text">
        <span class="weight-label">lbs</span>
      </div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-low">6-7</div>
      <button class="timer-btn" onclick="startTimer(75, 'Single-Leg RDL')">1:15</button>
    </div>
  </div>

  <div class="exercise" data-key="goblet-squat" data-sets="3" data-rest="90">
    <div class="check-col">
      <div class="num">2</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('goblet-squat')">
      <div class="name">Goblet Squat (3-sec pause)</div>
      <div class="meta">3&times;8 &middot; Rest 1:30</div>
      <div class="weight-row" onclick="event.stopPropagation()">
        <input class="weight-input" data-weight-key="goblet-squat" placeholder="—" inputmode="text">
        <span class="weight-label">lbs</span>
      </div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-low">6</div>
      <button class="timer-btn" onclick="startTimer(90, 'Goblet Squat')">1:30</button>
    </div>
  </div>

  <div class="exercise" data-key="hip-abd" data-sets="3" data-rest="52">
    <div class="check-col">
      <div class="num">3</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('hip-abd')">
      <div class="name">Side-Lying Hip Abduction</div>
      <div class="meta">3&times;12/side &middot; Rest 0:45-1:00</div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-med">7</div>
      <button class="timer-btn" onclick="startTimer(52, 'Hip Abduction')">0:52</button>
    </div>
  </div>

  <div class="exercise" data-key="tib-raise" data-sets="3" data-rest="52">
    <div class="check-col">
      <div class="num">4</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('tib-raise')">
      <div class="name">Tibialis Raise</div>
      <div class="meta">3&times;15 &middot; Rest 0:45-1:00</div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-med">7</div>
      <button class="timer-btn" onclick="startTimer(52, 'Tibialis Raise')">0:52</button>
    </div>
  </div>

  <div class="exercise" data-key="ecc-calf" data-sets="3" data-rest="75">
    <div class="check-col">
      <div class="num">5</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('ecc-calf')">
      <div class="name">Eccentric Calf Raise</div>
      <div class="meta">3&times;12/side &middot; up 2, down 1 &middot; Rest 1-1:30</div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-med">7</div>
      <button class="timer-btn" onclick="startTimer(75, 'Eccentric Calf Raise')">1:15</button>
    </div>
  </div>

  <div class="exercise" data-key="dead-bug" data-sets="3" data-rest="38">
    <div class="check-col">
      <div class="num">6</div>
      <div class="set-dots"></div>
    </div>
    <div class="info" onclick="openDetail('dead-bug')">
      <div class="name">Dead Bug</div>
      <div class="meta">3&times;8/side &middot; Rest 0:30-0:45</div>
    </div>
    <div class="rpe-wrap">
      <div class="rpe rpe-low">6</div>
      <button class="timer-btn" onclick="startTimer(38, 'Dead Bug')">0:38</button>
    </div>
  </div>

  <div class="reset-bar">
    <button class="reset-btn" onclick="resetSets('b')">Reset Sets</button>
  </div>
</div>

<!-- DETAIL OVERLAY -->
<div class="overlay" id="overlay" onclick="closeDetail(event)">
  <div class="detail-sheet" id="detail-sheet">
    <div class="sheet-handle"></div>
    <button class="close-btn" onclick="closeDetail(event, true)">&times;</button>
    <div id="detail-content"></div>
  </div>
</div>

<!-- TIMER OVERLAY -->
<div class="timer-overlay" id="timer-overlay">
  <div class="timer-label" id="timer-label">REST</div>
  <div class="timer-ring">
    <svg viewBox="0 0 220 220">
      <circle class="track" cx="110" cy="110" r="100"/>
      <circle class="progress" id="timer-progress" cx="110" cy="110" r="100"
        stroke-dasharray="628.32" stroke-dashoffset="0"/>
    </svg>
    <div class="time-center">
      <div class="timer-display" id="timer-display">0:00</div>
    </div>
  </div>
  <button class="timer-cancel" onclick="cancelTimer()">Done</button>
</div>

<script>
// Exercise detail data
const details = {
  'lat-walks': {
    title: 'Banded Lateral Walks',
    sections: [
      { heading: 'Setup', items: ['Mini-band around ankles (harder) or above knees (easier)', 'Athletic stance: slight hip hinge, knees soft, chest tall'] },
      { heading: 'Execution', items: ['Step sideways under control \u2014 don\u2019t let feet snap together', 'Keep toes forward (or slightly in), knees gently pushed out', '10 steps one way, 10 back'] },
      { heading: 'Cues', items: ['Feel it on the side of the hips, not quads', 'Don\u2019t sway your torso or let the band pull knees inward'] }
    ]
  },
  'glute-bridge': {
    title: 'Banded Glute Bridges (2-sec hold)',
    sections: [
      { heading: 'Setup', items: ['Band above knees. Lie on back, feet flat, heels ~6\u201310\u2033 from butt'] },
      { heading: 'Execution', items: ['Exhale, posteriorly tilt pelvis slightly (ribs down), drive through heels', 'At top: squeeze glutes, knees press out, 2-sec hold', 'Lower under control'] },
      { heading: 'Cues', items: ['Top position = straight line shoulders\u2013hips\u2013knees (no over-arching)', 'Hamstrings cramping? Move feet farther away, focus on pelvis tuck + glute squeeze'] }
    ]
  },
  'leg-swings': {
    title: 'Leg Swings',
    sections: [
      { heading: 'Setup', items: ['Hold a wall/rack lightly. Stand tall.'] },
      { heading: 'Execution', items: ['Front/back: swing leg like a pendulum, hips square, range increases gradually', 'Lateral: swing across body then out to side; torso stays quiet', '10 each direction per leg'] },
      { heading: 'Cues', items: ['Smooth, not violent \u2014 you\u2019re greasing range, not stretching hard'] }
    ]
  },
  'trap-bar-dl': {
    title: 'Trap Bar Deadlift \u2014 3\u00d75',
    sections: [
      { heading: 'Setup', items: ['Midfoot centered in the trap bar, feet hip-width', 'Hinge down, grab handles, shins near vertical, hips back', 'Shoulders slightly in front of hips; spine neutral; lats \u201con\u201d (armpits tight)'] },
      { heading: 'Execution', items: ['Big brace \u2192 push the floor away', 'Bar rises as hips and shoulders come up together', 'Stand tall at top (glutes on), then hinge back to lower with control'] },
      { heading: 'Cues', items: ['Think \u201cleg press the floor\u201d rather than yanking', 'Don\u2019t let knees collapse in or hips shoot up first', 'Lower back feeling it? Use higher handles, reduce load, exaggerate hinge on the way down'] }
    ]
  },
  'bss': {
    title: 'Bulgarian Split Squat (DB) \u2014 3\u00d78/side',
    sections: [
      { heading: 'Setup', items: ['Back foot on bench (laces down)', 'Front foot far enough that heel stays down', 'Hold DBs at sides; slight forward torso lean is fine'] },
      { heading: 'Execution', items: ['Lower straight down with a small forward lean; front knee tracks over toes', 'Bottom: front thigh near parallel (or as tolerated)', 'Drive up through midfoot/heel of front leg'] },
      { heading: 'Cues', items: ['Keep hips square \u2014 don\u2019t twist', 'Feeling it mostly in the knee? Take longer stance, sit back more', 'Balance an issue? Do kickstand split squat (rear toes on floor) or hold a rack'] }
    ]
  },
  'copenhagen': {
    title: 'Copenhagen Plank \u2014 3\u00d720\u201330 sec/side',
    sections: [
      { heading: 'Setup', items: ['Side plank position, top leg on a bench', 'Easier: bench supports the knee', 'Harder: bench supports ankle/foot', 'Bottom leg hangs under you'] },
      { heading: 'Execution', items: ['Lift hips so body is straight head-to-heel', 'Actively pull supported leg down into bench (adductors on)', 'Hold; breathe shallow but controlled'] },
      { heading: 'Cues', items: ['Don\u2019t let hips rotate or sag', 'Groin feels off? Shorten lever (knee on bench) and reduce hold time'] }
    ]
  },
  'calf-raise-heavy': {
    title: 'Heavy Calf Raise \u2014 3\u00d710',
    sections: [
      { heading: 'Setup', items: ['Ball of foot on edge/platform; heel free', 'Slight knee bend (more soleus) or straight leg (more gastroc) \u2014 be consistent'] },
      { heading: 'Execution', items: ['Rise to a strong top contraction (no bouncing)', 'Lower 3 seconds to full stretch', 'Hold 2 seconds at bottom (heel down, stretched), then repeat'] },
      { heading: 'Cues', items: ['Keep ankle tracking straight \u2014 don\u2019t roll outward', 'If you bounce out of the bottom, the set doesn\u2019t count \u2014 own the pause'] }
    ]
  },
  'pallof': {
    title: 'Pallof Press \u2014 3\u00d78/side',
    sections: [
      { heading: 'Setup', items: ['Cable or band at chest height. Stand sideways to anchor', 'Feet shoulder-width, slight knee bend; ribs stacked over pelvis'] },
      { heading: 'Execution', items: ['Hold handle at sternum, brace', 'Press straight out, pause 1 sec, return', 'Goal: zero torso rotation'] },
      { heading: 'Cues', items: ['Twisting? Step farther from anchor or reduce resistance', 'Keep shoulders down \u2014 don\u2019t shrug'] }
    ]
  },
  'hip-flexor-march': {
    title: 'Banded Hip Flexor March \u2014 3\u00d710/side',
    sections: [
      { heading: 'Setup', items: ['Band around feet or anchored behind you', 'Stand tall holding support lightly'] },
      { heading: 'Execution', items: ['Lift knee to ~hip height without leaning back', 'Pause briefly at top; control down'] },
      { heading: 'Cues', items: ['Keep pelvis level \u2014 no hiking', 'Hip pinching? Reduce range and slow it down'] }
    ]
  },
  'hip-switches': {
    title: '90/90 Hip Switches',
    sections: [
      { heading: 'Setup', items: ['Sit with both knees bent ~90\u00b0, one leg in front, one to the side'] },
      { heading: 'Execution', items: ['Rotate knees to the other side without using hands if possible', 'Stay tall; move smoothly'] },
      { heading: 'Cues', items: ['Hands can assist \u2014 use less assistance over time'] }
    ]
  },
  'hip-cars': {
    title: 'Hip CARs',
    sections: [
      { heading: 'Setup', items: ['Hold a wall for balance. Stand tall.'] },
      { heading: 'Execution', items: ['Lift knee \u2192 rotate hip outward \u2192 open to side \u2192 extend behind \u2192 return', 'Then reverse direction. Slow and controlled.'] },
      { heading: 'Cues', items: ['Minimize pelvic movement \u2014 \u201chip moves, torso stays\u201d'] }
    ]
  },
  'couch-stretch': {
    title: 'Couch Stretch / Hip Flexor \u2014 45 sec/side',
    sections: [
      { heading: 'Setup', items: ['Couch stretch: back knee near wall, shin up wall; front foot forward', 'Half-kneeling: back knee down, front foot planted'] },
      { heading: 'Execution', items: ['Tuck pelvis slightly (glute of back leg on), ribs down', 'Gently shift forward', 'Optional: reach overhead on back-leg side'] },
      { heading: 'Cues', items: ['Avoid arching low back to fake range'] }
    ]
  },
  'ankle-circles': {
    title: 'Ankle Circles',
    sections: [
      { heading: 'Execution', items: ['Lift foot off ground; make slow circles both directions', 'Move through full range without forcing'] }
    ]
  },
  'sl-rdl': {
    title: 'Single-Leg RDL (DB) \u2014 3\u00d78/side',
    sections: [
      { heading: 'Setup', items: ['DB in opposite hand of stance leg (best for hip control)', 'Soft knee on stance leg; hips square'] },
      { heading: 'Execution', items: ['Hinge: push hips back, free leg reaches behind as counterbalance', 'Stop when torso is near parallel or pelvis starts to open', 'Drive hips forward to stand tall'] },
      { heading: 'Cues', items: ['Back stays long \u2014 don\u2019t rotate open', 'Balance the limiter? Tap back toes lightly (\u201ckickstand RDL\u201d)'] }
    ]
  },
  'goblet-squat': {
    title: 'Goblet Squat (3-sec pause) \u2014 3\u00d78',
    sections: [
      { heading: 'Setup', items: ['Hold DB/kettlebell at chest. Feet shoulder-width, toes slightly out.'] },
      { heading: 'Execution', items: ['Sit down between hips, knees track over toes', 'Bottom: 3-second pause with brace (no relaxing)', 'Stand by pushing the floor away'] },
      { heading: 'Cues', items: ['Heels lifting? Widen stance slightly and/or elevate heels a bit', 'Don\u2019t collapse at the bottom \u2014 stay tight during the pause'] }
    ]
  },
  'hip-abd': {
    title: 'Side-Lying Hip Abduction \u2014 3\u00d712/side',
    sections: [
      { heading: 'Abduction Version', items: ['Lie on side, bottom knee bent, top leg straight, toes slightly down', 'Lift top leg 12\u201318 inches without rolling hips back', 'Pause briefly at top; lower slow'] },
      { heading: 'Clamshell Version (easier)', items: ['Knees bent, heels together, hips stacked', 'Open top knee without rotating pelvis', 'Add mini-band above knees to progress'] },
      { heading: 'Cues', items: ['Don\u2019t roll torso backward to cheat height'] }
    ]
  },
  'tib-raise': {
    title: 'Tibialis Raise \u2014 3\u00d715',
    sections: [
      { heading: 'Setup', items: ['Back against wall, feet 6\u201312 inches out, heels down'] },
      { heading: 'Execution', items: ['Lift toes toward shins (dorsiflex), pause 1 sec, lower slow', 'Keep knees mostly straight; motion from the ankle'] },
      { heading: 'Cues', items: ['Don\u2019t rock backward \u2014 heels stay planted'] }
    ]
  },
  'ecc-calf': {
    title: 'Eccentric Calf Raise \u2014 3\u00d712/side',
    sections: [
      { heading: 'Setup', items: ['Ball of foot on step edge; use railing for balance'] },
      { heading: 'Execution', items: ['Use both legs to rise to the top', 'Shift weight to one leg', 'Lower on that leg for 3\u20134 seconds to full stretch', 'Put second foot back on to help rise again'] },
      { heading: 'Cues', items: ['Control every descent \u2014 no bouncing', 'Keep ankle neutral \u2014 don\u2019t roll outward'] }
    ]
  },
  'dead-bug': {
    title: 'Dead Bug \u2014 3\u00d78/side',
    sections: [
      { heading: 'Setup', items: ['On back, arms up, hips/knees at 90\u00b0', 'Low back gently pressed into floor (ribs down)'] },
      { heading: 'Execution', items: ['Extend opposite arm and leg slowly while maintaining low-back contact', 'Pause briefly at full extension, return, switch sides'] },
      { heading: 'Cues', items: ['Low back pops up? Shorten range (bend knee more, reach less far) and slow down', '\u201cExhale to lock ribs down,\u201d then move'] }
    ]
  }
};

// ── Set tracking ──
function initDots() {
  document.querySelectorAll('.exercise').forEach(ex => {
    const sets = parseInt(ex.dataset.sets) || 0;
    const key = ex.dataset.key;
    const dotsEl = ex.querySelector('.set-dots');
    if (!dotsEl || sets === 0) return;
    dotsEl.innerHTML = '';
    const saved = getSetState(key);
    for (let i = 0; i < sets; i++) {
      const dot = document.createElement('div');
      dot.className = 'set-dot' + (saved[i] ? ' filled' : '');
      dot.addEventListener('click', function(e) {
        e.stopPropagation();
        this.classList.toggle('filled');
        saveSetState(key, ex);
        checkAllDone(ex);
      });
      dotsEl.appendChild(dot);
    }
    checkAllDone(ex);
  });
}

function checkAllDone(ex) {
  const dots = ex.querySelectorAll('.set-dot');
  const filled = ex.querySelectorAll('.set-dot.filled');
  if (dots.length > 0 && dots.length === filled.length) {
    ex.classList.add('all-done');
  } else {
    ex.classList.remove('all-done');
  }
}

function getSetState(key) {
  try {
    return JSON.parse(sessionStorage.getItem('sets_' + key)) || [];
  } catch { return []; }
}

function saveSetState(key, ex) {
  const dots = ex.querySelectorAll('.set-dot');
  const state = Array.from(dots).map(d => d.classList.contains('filled'));
  sessionStorage.setItem('sets_' + key, JSON.stringify(state));
}

function resetSets(session) {
  const container = document.getElementById('session-' + session);
  container.querySelectorAll('.exercise').forEach(ex => {
    const key = ex.dataset.key;
    sessionStorage.removeItem('sets_' + key);
    ex.querySelectorAll('.set-dot').forEach(d => d.classList.remove('filled'));
    ex.classList.remove('all-done');
  });
}

// ── Wake Lock ──
let wakeLock = null;
async function requestWakeLock() {
  try {
    if ('wakeLock' in navigator) {
      wakeLock = await navigator.wakeLock.request('screen');
    }
  } catch(e) {}
}
function releaseWakeLock() {
  if (wakeLock) { wakeLock.release(); wakeLock = null; }
}

// ── Timer ──
let timerInterval = null;
let timerRemaining = 0;
let timerTotal = 0;
const CIRCUMFERENCE = 2 * Math.PI * 100; // 628.32

function startTimer(seconds, label) {
  event.stopPropagation();
  requestWakeLock();
  timerTotal = seconds;
  timerRemaining = seconds;
  document.getElementById('timer-label').textContent = label;
  document.getElementById('timer-overlay').classList.add('open');
  updateTimerDisplay();
  updateTimerRing();

  const progress = document.getElementById('timer-progress');
  progress.classList.remove('done');
  document.getElementById('timer-display').classList.remove('done');

  clearInterval(timerInterval);
  timerInterval = setInterval(function() {
    timerRemaining--;
    updateTimerDisplay();
    updateTimerRing();
    if (timerRemaining <= 0) {
      clearInterval(timerInterval);
      timerInterval = null;
      document.getElementById('timer-display').classList.add('done');
      progress.classList.add('done');
      // Vibrate if supported
      if (navigator.vibrate) {
        navigator.vibrate([200, 100, 200, 100, 200]);
      }
      // Audio beep
      try {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        [0, 300, 600].forEach(function(delay) {
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.frequency.value = 880;
          gain.gain.value = 0.3;
          osc.start(ctx.currentTime + delay / 1000);
          osc.stop(ctx.currentTime + delay / 1000 + 0.15);
        });
      } catch(e) {}
    }
  }, 1000);
}

function updateTimerDisplay() {
  const t = Math.max(0, timerRemaining);
  const m = Math.floor(t / 60);
  const s = t % 60;
  document.getElementById('timer-display').textContent = m + ':' + (s < 10 ? '0' : '') + s;
}

function updateTimerRing() {
  const fraction = timerRemaining / timerTotal;
  const offset = CIRCUMFERENCE * (1 - fraction);
  document.getElementById('timer-progress').style.strokeDashoffset = offset;
}

function cancelTimer() {
  clearInterval(timerInterval);
  timerInterval = null;
  releaseWakeLock();
  document.getElementById('timer-overlay').classList.remove('open');
}

// ── Sessions ──
function autoSelect() {
  const day = new Date().getDay();
  if (day === 0) showSession('b');
  else if (day === 3) showSession('a');
  else showSession('a');
}

function showSession(id) {
  document.querySelectorAll('.session').forEach(s => s.classList.remove('visible'));
  document.getElementById('session-' + id).classList.add('visible');
  document.getElementById('btn-a').className = 'day-btn' + (id === 'a' ? ' active-a' : '');
  document.getElementById('btn-b').className = 'day-btn' + (id === 'b' ? ' active-b' : '');
}

// ── Detail sheet ──
function openDetail(key) {
  const d = details[key];
  if (!d) return;
  let html = '<h2>' + d.title + '</h2>';
  d.sections.forEach(function(s) {
    html += '<div class="detail-section"><h3>' + s.heading + '</h3><ul>';
    s.items.forEach(function(item) {
      html += '<li>' + item + '</li>';
    });
    html += '</ul></div>';
  });
  document.getElementById('detail-content').innerHTML = html;
  document.getElementById('overlay').classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeDetail(e, force) {
  if (force || e.target === document.getElementById('overlay')) {
    document.getElementById('overlay').classList.remove('open');
    document.body.style.overflow = '';
  }
}

// Swipe-down to close
let touchStartY = 0;
document.getElementById('detail-sheet').addEventListener('touchstart', function(e) {
  touchStartY = e.touches[0].clientY;
});
document.getElementById('detail-sheet').addEventListener('touchmove', function(e) {
  const dy = e.touches[0].clientY - touchStartY;
  if (dy > 80 && document.getElementById('detail-sheet').scrollTop === 0) {
    closeDetail(null, true);
  }
});

// ── Weight logging ──
function initWeights() {
  document.querySelectorAll('.weight-input').forEach(function(input) {
    var key = 'weight_' + input.dataset.weightKey;
    var saved = localStorage.getItem(key);
    if (saved) input.value = saved;
    input.addEventListener('change', function() {
      var val = this.value.trim();
      if (val) localStorage.setItem(key, val);
      else localStorage.removeItem(key);
    });
  });
}

// Init
autoSelect();
initDots();
initWeights();
</script>
</body>
</html>
